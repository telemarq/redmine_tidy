# A compose file that sets up a container to run redmine-tidy
# as a cron job once per day.

version: "3.8"

secrets:
  redmine_tidy_config:
    file: redmine-tidy.json

configs:
  crontab_config:
    file: crontab

services:
  redmine_tidy:
    build: .
    image: redmine_tidy
    secrets:
      - source: redmine_tidy_config
        target: /etc/redmine-tidy.json
    configs:
      - source: crontab_config
        target: /etc/crontabs/root   
        mode: 0600
    command: crond -l 4 -L /dev/stdout -f

